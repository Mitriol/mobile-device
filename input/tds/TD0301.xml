<?xml version="1.0" encoding="utf-8"?>
<technical-decisions xmlns:htm="http://www.w3.org/1999/xhtml"
                     xmlns="https://niap-ccevs.org/cc/v1">
    <bunch>
        <!--
         Replace entire f-elements from the base PP and update - f-components?
         Non-SFR changes made using XPATH expressions
        -->
        <applies-to max-inclusive="3.1" name="Mobile Device Fundamentals"/>

        <decision id='0301'>
            <notes>Updates to Administrator Management and Biometric Authenication</notes>

            <change xpath=".//f-element[@id='fmt_smf_ext.3.1']" mode="replace">
                <f-element id="fmt_smf_ext.3.1">
                    <title>The
                        <abbr linkend="TSF"/>
                        shall provide a mechanism that allows users to view a list of currently authorized
                        administrators and the management functions that each administrator is authorized to perform.
                    </title>
                    <aactivity>The evaluator shall cause the TOE to be enrolled into management. The evaluator shall
                        then invoke this mechanism and verify the ability to view that the device has been enrolled,
                        view the management functions that the administrator is authorized to perform.
                    </aactivity>
                </f-element>
            </change>

            <change xpath=".//f-element[@id='fia_bmg_ext.1.1']" mode="replace">
                <f-element id="fia_bmg_ext.1.1">
                    <title>The one-attempt
                        <abbr linkend="BAF"/>
                        False Accept Rate (<abbr linkend="FAR"/>) for
                        <assignable>biometric modality selected in
                            <linkref linkend="FIA_UAU.5.1"/>
                        </assignable>
                        shall not exceed <assignable>claimed FAR no greater than 1:100</assignable> with a one-attempt
                        BAF False Reject Rate (FRR) not to exceed 1 in <assignable>claimed FRR no greater than
                            1:10</assignable>.
                    </title>

                    <note role="application">If a BAF or "hybrid" is selected in FIA_UAU.5.1, FIA_BMG_EXT.1.1 must be
                        included in the ST. The assignment shall be completed for each biometric modality selected in
                        FIA_UAU.5.1. If multiple biometric modalities are selected in FIA_UAU.5.1, it is acceptable for
                        each modality to have a different FAR and FRR.

                        The False Accept Rate (FAR) is the measure of the likelihood that the biometric will incorrectly
                        accept an authentication attempt by an unauthorized user. A system's FAR typically is stated as
                        the proportion of verification transactions with wrongful claims of identity that are
                        incorrectly confirmed.

                        The False Reject Rate (FRR) is the measure of the likelihood that the biometric security system
                        will incorrectly reject an authentication attempt by an authorized user. A system's FRR
                        typically is stated as the proportion of verification transactions with truthful claims of
                        identity that are incorrectly denied.

                        Please note that without the use of hybrid authentication, multiple authentication attempts for
                        a BAF that is claimed to have a one-attempt FAR between 1:100 and 1:500 inclusive will not
                        produce an acceptable SAFAR in meeting FIA_BMG_EXT.1.2. More generally, depending on the number
                        of authentication attempts allowed for the BAF, the claimed FAR must be strong (or equivalently,
                        low) enough so that the SAFAR chosen in FIA_BMG_EXT.1.2 can be met within the 1% margin
                        mandated.

                        Generally testing environments for a biometric system in a mobile device are based on a single
                        legitimate user enrolling and test subjects attempt to authenticate. Since a thorough evaluation
                        for FAR and FRR meeting all the conditions of statistical independence is not feasible in the
                        timeframe of CC evaluations and in agreement with ISO/IEC 19795, the use of offline testing is
                        acceptable even if this causes the biometric system to deviate slightly from the evaluated
                        configuration. Additionally, full cross-comparison (i.e. all test subjects are compared to
                        non-self) is acceptable.

                        Detailed explanations corresponding to the testing environments that are acceptable, to include
                        the number of trials needed, can be found in Appendix H.1.
                    </note>
                    <aactivity>The evaluator shall verify that the TSS contains evidence supporting the testing and
                        calculations completed to determine the FAR and FRR. Appendix H provides guidance to how this
                        testing could be completed and to what error bars are expected when the Rule of 3 is applied.
                        The evaluator shall consult Appendix H as a reference, but should not treat it as a mandate. The
                        evaluator shall verify that the TSS contains evidence of whether online or offline testing was
                        used. If offline testing was completed, evidence describing the differences between the
                        biometric system used for testing and the TOE in the evaluated configuration, if any must be
                        included.

                        The following documentation is not required to be part of the TSS - it may be submitted as a
                        separate proprietary document. The evaluator shall verify the evidence includes how many
                        imposters were used for testing and that the testing describes how imposters are compared to
                        enrolled users, for example, if multiple devices for online testing or full cross-comparison for
                        offline testing was used. Adequate documentation is required to demonstrate that testing was
                        completed to support the claimed FAR and FRR.
                    </aactivity>
                </f-element>
            </change>

            <!-- Annoyingly here we need two changes since they're two separate elements -->
            <change xpath=".//appendix[@id='biometric']/section[@id='biometric1']/subsection[@id='sub3']/ctr[@id='biotable3']"
                    mode="replace">
                <ctr id="biotable3" pre="Table " ctr-type="table">: Comparison of false error rates, number of errors,
                    and number of test subjects needed for offline testing and full cross-comparison, given Rule of 3
                </ctr>
            </change>
            <change xpath=".//appendix[@id='biometric']/section[@id='biometric1']/subsection[@id='sub3']/htm:table[3]"
                    mode="replace">
                <htm:table>
                    <htm:tr class="header">
                        <htm:td>False Error Rate</htm:td>
                        <htm:td>False error rates, 90% confidence, <htm:i>c</htm:i> = 0.95
                        </htm:td>
                        <htm:td>Number of errors (rounded)</htm:td>
                        <htm:td>Number of test subjects needed</htm:td>
                    </htm:tr>
                    <htm:tr>
                        <htm:td>1% (1:100)</htm:td>
                        <htm:td>1% ± 0.95%</htm:td>
                        <htm:td>3</htm:td>
                        <htm:td>25</htm:td>
                    </htm:tr>
                    <htm:tr>
                        <htm:td>0.1% (1:1000)</htm:td>
                        <htm:td>0.1% ± 0.095%</htm:td>
                        <htm:td>3</htm:td>
                        <htm:td>78</htm:td>
                    </htm:tr>
                    <htm:tr>
                        <htm:td>0.01% (1:10000)</htm:td>
                        <htm:td>0.01% ± 0.0095%</htm:td>
                        <htm:td>3</htm:td>
                        <htm:td>246</htm:td>
                    </htm:tr>
                    <htm:tr>
                        <htm:td>0.001% (1:100000)</htm:td>
                        <htm:td>0.001% ± 0.00095%</htm:td>
                        <htm:td>3</htm:td>
                        <htm:td>776</htm:td>
                    </htm:tr>
                    <htm:tr>
                        <htm:td>0.0001% (1:1000000)</htm:td>
                        <htm:td>0.0001% ± 0.000095%</htm:td>
                        <htm:td>3</htm:td>
                        <htm:td>2450</htm:td>
                    </htm:tr>
                </htm:table>
            </change>
        </decision>
    </bunch>
</technical-decisions>
